; ============================
; Basic Settings
; ============================
error_reporting = E_ALL
display_errors = Off         ; Production: Off, Development: On
display_startup_errors = Off
log_errors = On
error_log = /var/log/php_errors.log

max_execution_time = 120      ; Maximum execution time in seconds
memory_limit = 512M           ; Adjust based on your server's resources
post_max_size = 50M           ; Max size of POST data
upload_max_filesize = 50M     ; Max upload file size
max_file_uploads = 20         ; Maximum number of files that can be uploaded simultaneously
default_charset = "UTF-8"     ; Set default character set
file_uploads = On             ; Enable file uploads

; ============================
; Performance Tuning
; ============================
opcache.enable = 1
opcache.memory_consumption = 128        ; Adjust based on your server's memory
opcache.interned_strings_buffer = 8
opcache.max_accelerated_files = 10000
opcache.validate_timestamps = 0         ; Set to 0 for production
realpath_cache_size = 4096K
realpath_cache_ttl = 600

; ============================
; Session Settings
; ============================
session.gc_maxlifetime = 1440       ; 24 minutes (1440 seconds)
session.save_path = "/var/lib/php/sessions"
session.cookie_secure = On          ; Use HTTPS for secure cookies
session.cookie_httponly = On        ; Prevent JavaScript access to session cookies
session.use_strict_mode = 1         ; Prevent uninitialized session ID usage

; ============================
; Security Settings
; ============================
expose_php = Off                  ; Hide PHP version in HTTP headers
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,show_source ; Disable risky functions
allow_url_fopen = On              ; Enable to fetch remote files
allow_url_include = Off           ; Disable to prevent remote script execution
cgi.fix_pathinfo = 0              ; Mitigate file upload attacks

; ============================
; Logging
; ============================


log_errors_max_len = 1024
ignore_repeated_errors = On
ignore_repeated_source = Off

; ============================
; Date and Time
; ============================
date.timezone = UTC               ; Change to your timezone, e.g., Asia/Ho_Chi_Minh

; ============================
; PDO and MySQL
; ============================
mysqli.allow_local_infile = Off
mysqli.cache_size = 2000
pdo_mysql.cache_size = 2000

; ============================
; Extensions
; ============================
extension = curl
extension = mysqli
extension = pdo_mysql
extension = mbstring
extension = openssl
extension = zip

; ============================
; Upload Handling
; ============================
upload_tmp_dir = /tmp/php_uploads
file_uploads = On
upload_max_filesize = 50M
post_max_size = 50M
max_file_uploads = 20

; ============================
; Output Buffering
; ============================
output_buffering = 4096
zlib.output_compression = On
zlib.output_compression_level = 6  ; Compression level (1 fastest, 9 best compression)

; ============================
; FPM-Specific (if using PHP-FPM)
; ============================
; Uncomment if running PHP-FPM
; php_admin_value[error_log] = /var/log/php-fpm/error.log
; php_admin_flag[log_errors] = On
